---
title: "Projekt_3"
author: "Kamil Sarzyniak, Piotr Stawarski"
date: '2024-11-06'
output: pdf
---

```{r}
library(forecast)
library(tseries)
library(MASS)
```
```{r}
n_values <- c(50, 100, 1000)
ar_values <- c(.1, .5, .9)
n_reps <- 1000
results <- vector("list", n_reps)
```



```{r}
n_values <- c(50, 100, 1000)
ar_values <- c(.1, .5, .9)

for (rep in 1:n_reps) {
  rep_results <- list()
  
  for (N in n_values) {
      estimates <- matrix(NA, nrow = N, ncol = 3)
      stderrs <- matrix(NA, nrow = N, ncol = 3)
      residual_acf <- matrix(NA, nrow = N, ncol = 20)
      i <- 1
    
      for (AR in ar_values) {
        xt1 = arima.sim(list(order=c(1,0,0), ar=AR), n=N)
        
        xt3 = Arima(xt1, order = c(3,0,0))
        
        estimates[i, ] <- xt3$coef[1:3]
        stderrs[i, ] <- sqrt(diag(xt3$var.coef))[1:3]
        residual_acf[i, ] <- acf(residuals(xt3), plot = FALSE)$acf[2:21]
        i <- i + 1
      }
      rep_results[[paste0("N_", N)]] <- list(
      estimates = estimates,
      stderrs = stderrs,
      residual_acf = residual_acf
    )
  }
  results[[rep]] <- rep_results
}
```

